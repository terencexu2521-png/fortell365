name: SEO Auto Generator

on:
  schedule:
    - cron: '0 2 * * *'
  workflow_dispatch:
    inputs:
      count:
        description: 'Number of articles to generate'
        required: false
        default: '30'
        type: string

jobs:
  generate-seo:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: Create SEO generator script
      run: |
        cat > seo_generator.py << 'EOF'
#!/usr/bin/env python3
import random
import os
from datetime import datetime

# Create directories
os.makedirs('seo_pages', exist_ok=True)
os.makedirs('public/seo', exist_ok=True)

# Question templates for SEO content
templates = [
    "æˆ‘æ˜¯{age}å²è¿˜æ²¡è°ˆè¿‡æ‹çˆ±ï¼Œå…«å­—æ˜¯ä¸æ˜¯æœ‰å•¥é—®é¢˜ï¼Ÿ",
    "{age}å¹´å±{animal}å¥³å’Œä»€ä¹ˆå±ç›¸çš„ç”·ç”Ÿæœ€é€‚åˆï¼Ÿ",
    "{year}å¹´æ¡ƒèŠ±è¿æ€ä¹ˆæ ·ï¼Ÿä»€ä¹ˆæ—¶å€™èƒ½è„±å•ï¼Ÿ",
    "æˆ‘å’Œå±{animal}çš„äººå…«å­—åˆä¸åˆï¼Ÿåœ¨ä¸€èµ·ä¼šå¹¸ç¦å—ï¼Ÿ",
    "å±{animal}çš„{age}å²å¥³ç”Ÿï¼Œæ„Ÿæƒ…è¿åŠ¿å¦‚ä½•ï¼Ÿ",
    "ä»å…«å­—çœ‹ï¼Œæˆ‘å’Œæ‹äººçš„ç¼˜åˆ†æ·±å—ï¼Ÿ",
    "æˆ‘çš„å…«å­—æ˜¾ç¤º{emotion}è¿ä»€ä¹ˆæ—¶å€™æ¥ï¼Ÿ",
    "å‘½é‡Œæ˜¾ç¤ºçš„æœ€ä½³è„±å•æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ",
    "{age}å²æœ¬å‘½å¹´ï¼Œæ„Ÿæƒ…æ–¹é¢ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ",
    "æˆ‘æ˜¯ç¦»å¼‚å¸¦å­©ï¼Œå…«å­—é‡Œè¿˜æœ‰æ²¡æœ‰å†å©šçš„ç¼˜åˆ†ï¼Ÿ"
]

# Variables
ages = ["25", "28", "30", "32", "35", "38", "40"]
animals = ["é¼ ", "ç‰›", "è™", "å…”", "é¾™", "è›‡", "é©¬", "ç¾Š", "çŒ´", "é¸¡", "ç‹—", "çŒª"]
years = ["2025", "2026", "2027"]
emotions = ["æ¡ƒèŠ±", "æ­£ç¼˜", "å§»ç¼˜", "æ‹çˆ±", "æ„Ÿæƒ…"]

def generate_seo_content(question):
    """Generate SEO-optimized HTML content"""
    current_month = datetime.now().strftime("%Yå¹´%mæœˆ")
    
    html_content = f"""<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{question} | Fortell365ä¸“ä¸šå‘½ç†</title>
    <meta name="description" content="{question}ä¸“ä¸šå‘½ç†åˆ†æï¼Œä»å…«å­—ç´«å¾®æ–—æ•°è§’åº¦è§£è¯»æ„Ÿæƒ…è¿åŠ¿ã€‚Fortell365æä¾›ä¸“ä¸šå‘½ç†æŒ‡å¯¼ã€‚">
    <meta name="keywords" content="å…«å­—,å‘½ç†,ç´«å¾®æ–—æ•°,æ¡ƒèŠ±è¿,æ­£ç¼˜,å§»ç¼˜,æ„Ÿæƒ…è¿åŠ¿,è„±å•">
    <style>
        body {{ font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 20px; }}
        .header {{ text-align: center; margin-bottom: 40px; }}
        .category {{ background: linear-gradient(135deg, #f5f3ff, #fef3c7); padding: 8px 16px; border-radius: 20px; font-size: 14px; color: #7c3aed; display: inline-block; }}
        h1 {{ color: #1e293b; font-size: 2.5rem; margin: 20px 0; }}
        .meta {{ color: #64748b; margin-bottom: 40px; }}
        .content {{ background: white; padding: 40px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }}
        h2 {{ color: #1e293b; font-size: 1.5rem; margin: 30px 0 15px 0; border-left: 4px solid #7c3aed; padding-left: 15px; }}
        ul {{ margin: 15px 0; padding-left: 20px; }}
        li {{ margin: 8px 0; }}
        .cta {{ background: linear-gradient(135deg, #7c3aed, #a855f7); color: white; padding: 30px; border-radius: 12px; text-align: center; margin: 40px 0; }}
        .cta h3 {{ margin: 0 0 10px 0; font-size: 1.3rem; }}
        .cta p {{ margin: 0 0 20px 0; color: #f3f4f6; }}
        .btn {{ background: white; color: #7c3aed; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: bold; display: inline-block; }}
    </style>
</head>
<body>
    <div class="header">
        <div class="category">å…«å­—å‘½ç† Â· æ„Ÿæƒ…è¿åŠ¿</div>
        <h1>{question}</h1>
        <div class="meta">Fortell365 Â· ä¸“ä¸šå‘½ç†å›¢é˜Ÿ Â· {current_month}</div>
    </div>
    
    <div class="content">
        <h2>ä¸€ã€è¿™ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆå¾ˆå¤šäººä¼šå…³å¿ƒ</h2>
        <p>{question}æ˜¯å¾ˆå¤šäººå…³å¿ƒçš„è¯é¢˜ã€‚åœ¨å½“ä»Šç¤¾ä¼šï¼Œäººä»¬å¯¹æ„Ÿæƒ…å’Œå©šå§»çš„å…³æ³¨åº¦è¶Šæ¥è¶Šé«˜ã€‚ç‰¹åˆ«æ˜¯éšç€å¹´é¾„çš„å¢é•¿ï¼Œå‘¨å›´äººå¯¹æ„Ÿæƒ…çŠ¶æ€çš„å…³å¿ƒå’Œè¯¢é—®ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚</p>
        <p>å¾ˆå¤šäººä¼šåœ¨ç‰¹å®šçš„äººç”Ÿé˜¶æ®µäº§ç”Ÿè¿™æ ·çš„ç–‘é—®ï¼Œè¿™åæ˜ äº†äººä»¬å¯¹æœªæ¥æ„Ÿæƒ…ç”Ÿæ´»çš„æœŸå¾…å’Œæ‹…å¿§ã€‚äº†è§£è‡ªå·±çš„å‘½ç†è¿åŠ¿ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æŠŠæ¡æ„Ÿæƒ…æ–¹å‘ã€‚</p>

        <h2>äºŒã€ä»å‘½ç†è§’åº¦çœ‹ï¼Œæ ¸å¿ƒç»“è®ºæ˜¯ä»€ä¹ˆ</h2>
        <p>ä»å…«å­—ç´«å¾®æ–—æ•°çš„è§’åº¦æ¥çœ‹ï¼Œæ¯ä¸ªäººçš„æ„Ÿæƒ…è¿åŠ¿éƒ½æœ‰å…¶ç‹¬ç‰¹çš„è§„å¾‹å’ŒèŠ‚å¥ã€‚å‘½ç†ä¸æ˜¯å®¿å‘½è®ºï¼Œè€Œæ˜¯ä¸€ç§æŒ‡å¯¼å’Œå‚è€ƒã€‚</p>
        <p>å…«å­—æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªäººåœ¨æ„Ÿæƒ…æ–¹é¢çš„å¤©èµ‹ã€æœºé‡å’Œå¯èƒ½é¢ä¸´çš„æŒ‘æˆ˜ã€‚é€šè¿‡åˆ†æå‘½ç›˜ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£è‡ªå·±åœ¨æ„Ÿæƒ…ä¸­çš„ä¼˜åŠ¿å’Œæ”¹è¿›æ–¹å‘ã€‚</p>

        <h2>ä¸‰ã€ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µ</h2>
        <p>å‘½ç†ä¸Šçš„æ„Ÿæƒ…è¿åŠ¿å—å¤šç§å› ç´ å½±å“ï¼š</p>
        <ul>
            <li><strong>åŸç”Ÿå…«å­—ç»“æ„</strong>ï¼šå‘½ç›˜ä¸­åæ˜ çš„å…ˆå¤©æ€§æ ¼ç‰¹è´¨å’Œæ„Ÿæƒ…æ¨¡å¼</li>
            <li><strong>å¤§è¿æµå¹´</strong>ï¼šä¸åŒæ—¶é—´æ®µè¿åŠ¿çš„å˜åŒ–å’Œæœºé‡</li>
            <li><strong>äº”è¡Œå¹³è¡¡</strong>ï¼šä¸ªäººäº”è¡Œç‰¹è´¨å¯¹æ„Ÿæƒ…å…³ç³»çš„å½±å“</li>
            <li><strong>ç¤¾äº¤ç¯å¢ƒ</strong>ï¼šç°å®ç”Ÿæ´»ä¸­çš„äº¤å‹åœˆå­å’Œæœºä¼š</li>
        </ul>
        <p>è¿™äº›å› ç´ ç›¸äº’ä½œç”¨ï¼Œå…±åŒæ„æˆäº†ä¸€ä¸ªäººçš„æ„Ÿæƒ…è¿åŠ¿å…¨è²Œã€‚</p>

        <h2>å››ã€å®ç”¨çš„æ”¹å–„å»ºè®®</h2>
        <p>åŸºäºå‘½ç†åˆ†æï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å®ç”¨çš„å»ºè®®ï¼š</p>
        <ul>
            <li><strong>ä¸»åŠ¨å‡ºå‡»</strong>ï¼šæ‰©å¤§ç¤¾äº¤åœˆå­ï¼Œåˆ›é€ æ›´å¤šç›¸è¯†æœºä¼š</li>
            <li><strong>æå‡è‡ªæˆ‘</strong>ï¼šä»å†…å¤–åœ¨ä¸¤æ–¹é¢æå‡ä¸ªäººé­…åŠ›</li>
            <li><strong>æ—¶æœºæŠŠæ¡</strong>ï¼šå…³æ³¨è¿åŠ¿å˜åŒ–ï¼Œåœ¨åˆé€‚æ—¶æœºä¸»åŠ¨è¡ŒåŠ¨</li>
            <li><strong>å¿ƒæ€è°ƒæ•´</strong>ï¼šä¿æŒç§¯æå¿ƒæ€ï¼Œç›¸ä¿¡ç¼˜åˆ†è‡ªç„¶åˆ°æ¥</li>
        </ul>

        <h2>äº”ã€ç»“è¯­</h2>
        <p>{question}è¿™æ ·çš„ç–‘é—®å¾ˆæ­£å¸¸ï¼Œè¯´æ˜æ‚¨å¯¹æ„Ÿæƒ…ç”Ÿæ´»æœ‰æ‰€æœŸå¾…ã€‚å‘½ç†æ˜¯ä¸€ç§æ–‡åŒ–ä¼ ç»Ÿå’Œæ™ºæ…§ä¼ æ‰¿ï¼Œå®ƒèƒ½ç»™æˆ‘ä»¬æä¾›ä¸€äº›å‚è€ƒå’ŒæŒ‡å¯¼ã€‚</p>
        <p>æœ€é‡è¦çš„æ˜¯ï¼Œè¦ç›¸ä¿¡è‡ªå·±çš„åŠªåŠ›å’ŒçœŸè¯šï¼ŒåŒæ—¶ä¿æŒå¼€æ”¾çš„å¿ƒæ€ã€‚Fortell365 è‡´åŠ›äºä¸ºæ¯ä¸€ä½ç”¨æˆ·æä¾›ä¸“ä¸šçš„å‘½ç†åˆ†æï¼Œå¸®åŠ©å¤§å®¶æ›´å¥½åœ°äº†è§£è‡ªå·±ï¼ŒæŠŠæ¡æ„Ÿæƒ…æœºé‡ã€‚</p>
    </div>
    
    <div class="cta">
        <h3>æƒ³äº†è§£æ›´å¤šå‘½ç†å¥¥ç§˜ï¼Ÿ</h3>
        <p>Fortell365æä¾›ä¸“ä¸šçš„å…«å­—ç´«å¾®æ–—æ•°åˆ†æï¼Œä¸ªæ€§åŒ–è§£è¯»æ‚¨çš„å‘½ç†è¿åŠ¿</p>
        <a href="/generate/bazi" class="btn">ç”Ÿæˆå…«å­—æŠ¥å‘Š</a>
    </div>
</body>
</html>"""
    
    return html_content

# Generate SEO articles
generated_count = 0
for i in range(30):
    template = random.choice(templates)
    question = template.format(
        age=random.choice(ages),
        animal=random.choice(animals),
        year=random.choice(years),
        emotion=random.choice(emotions)
    )
    
    # Generate filename
    filename = f"seo-{question.replace('ï¼Ÿ', '').replace('ï¼Œ', '').replace('ï¼Ÿ', '').replace('ï¼Ÿ', '')[:30]}.html"
    filepath = os.path.join("seo_pages", filename)
    
    # Generate content
    html_content = generate_seo_content(question)
    
    # Save file
    with open(filepath, 'w', encoding='utf-8') as f:
        f.write(html_content)
    
    generated_count += 1

print(f"âœ… æˆåŠŸç”Ÿæˆ {generated_count} ç¯‡SEOæ–‡ç« ")
        EOF
    
    - name: Generate SEO articles
      run: |
        python3 seo_generator.py
        
        # Verify files were created
        FILE_COUNT=$(find seo_pages -name "*.html" | wc -l)
        echo "ç”Ÿæˆçš„æ–‡ä»¶æ•°é‡: $FILE_COUNT"
        
        if [ $FILE_COUNT -gt 0 ]; then
          echo "âœ… SEOæ–‡ç« ç”ŸæˆæˆåŠŸ"
          # Copy to public directory
          mkdir -p public/seo
          cp seo_pages/*.html public/seo/
          echo "âœ… æ–‡ä»¶å¤åˆ¶å®Œæˆ"
        else
          echo "âŒ æ²¡æœ‰ç”ŸæˆHTMLæ–‡ä»¶"
          exit 1
        fi
    
    - name: Commit and push
      run: |
        git config --global user.name "Fortell365 Bot"
        git config --global user.email "bot@fortell365.com"
        
        git add public/seo/
        
        if git diff --cached --quiet; then
          echo "æ²¡æœ‰å˜æ›´éœ€è¦æäº¤"
          exit 0
        fi
        
        FILE_COUNT=$(find seo_pages -name "*.html" | wc -l)
        git commit -m "ğŸ¤– Auto SEO content - $FILE_COUNT articles

- Generated: $(date '+%Y-%m-%d %H:%M:%S')
- Articles: $FILE_COUNT
- Template: Fortell365å‘½ç†SEO"
        
        git push origin main
        echo "âœ… æ¨é€åˆ°GitHubæˆåŠŸ"
    
    - name: Success notification
      run: |
        FILE_COUNT=$(find seo_pages -name "*.html" | wc -l)
        echo "ğŸ‰ SEOè‡ªåŠ¨åŒ–éƒ¨ç½²æˆåŠŸå®Œæˆï¼"
        echo "ğŸ“Š ç”Ÿæˆç»Ÿè®¡ï¼š"
        echo "   - æ–‡ç« æ•°é‡: $FILE_COUNT"
        echo "   - ç”Ÿæˆæ—¶é—´: $(date)"
        echo "   - ä¸»é¢˜: å…«å­—å‘½ç†æ„Ÿæƒ…è¿åŠ¿"
        echo "   - ä»“åº“: ${{ github.repository }}"
