name: Simple SEO Generator

on:
  schedule:
    - cron: '0 2 * * *'
  workflow_dispatch:
    inputs:
      count:
        description: 'Number of articles to generate'
        required: false
        default: '30'
        type: string

jobs:
  generate-seo:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Generate SEO content
      run: |
        python3 -c "
        import random, os, datetime
        
        os.makedirs('seo_pages', exist_ok=True)
        os.makedirs('public/seo', exist_ok=True)
        
        questions = [
            'æˆ‘æ˜¯{age}å²è¿˜æ²¡è°ˆè¿‡æ‹çˆ±ï¼Œå…«å­—æ˜¯ä¸æ˜¯æœ‰å•¥é—®é¢˜ï¼Ÿ',
            '{age}å¹´å±{animal}å¥³å’Œä»€ä¹ˆå±ç›¸çš„ç”·ç”Ÿæœ€é€‚åˆï¼Ÿ',
            '{year}å¹´æ¡ƒèŠ±è¿æ€ä¹ˆæ ·ï¼Ÿä»€ä¹ˆæ—¶å€™èƒ½è„±å•ï¼Ÿ',
            'æˆ‘å’Œå±{animal}çš„äººå…«å­—åˆä¸åˆï¼Ÿåœ¨ä¸€èµ·ä¼šå¹¸ç¦å—ï¼Ÿ',
            'å±{animal}çš„{age}å²å¥³ç”Ÿï¼Œæ„Ÿæƒ…è¿åŠ¿å¦‚ä½•ï¼Ÿ'
        ]
        
        ages = ['25', '28', '30', '32', '35', '38', '40']
        animals = ['é¼ ', 'ç‰›', 'è™', 'å…”', 'é¾™', 'è›‡', 'é©¬', 'ç¾Š', 'çŒ´', 'é¸¡', 'ç‹—', 'çŒª']
        years = ['2025', '2026', '2027']
        
        for i in range(30):
            question = random.choice(questions).format(
                age=random.choice(ages),
                animal=random.choice(animals),
                year=random.choice(years)
            )
            
            title = f'{question} | Fortell365ä¸“ä¸šå‘½ç†'
            description = f'{question}ä¸“ä¸šå‘½ç†åˆ†æ'
            
            html = f'''<!DOCTYPE html>
<html lang=\"zh-CN\">
<head>
  <meta charset=\"UTF-8\">
  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">
  <title>{title}</title>
  <meta name=\"description\" content=\"{description}\">
</head>
<body>
  <article class=\"max-w-3xl mx-auto px-4 py-12\">
    <div class=\"text-center mb-10\">
      <span class=\"inline-block px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm mb-4\">å…«å­—å‘½ç† Â· æ„Ÿæƒ…è¿åŠ¿</span>
      <h1 class=\"text-3xl md:text-4xl font-bold text-slate-900 mb-4 leading-tight\">{question}</h1>
      <p class=\"text-slate-500\">Fortell365 Â· ä¸“ä¸šå‘½ç†å›¢é˜Ÿ Â· {datetime.datetime.now().strftime(\"%Yå¹´%mæœˆ\")}</p>
    </div>
    
    <div class=\"prose prose-slate max-w-none bg-white rounded-2xl p-8 shadow-sm\">
      <h2>ä¸€ã€è¿™ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆå¾ˆå¤šäººä¼šå…³å¿ƒ</h2>
      <p>{question}æ˜¯å¾ˆå¤šäººå…³å¿ƒçš„è¯é¢˜ã€‚åœ¨å½“ä»Šç¤¾ä¼šï¼Œäººä»¬å¯¹æ„Ÿæƒ…å’Œå©šå§»çš„å…³æ³¨åº¦è¶Šæ¥è¶Šé«˜ã€‚</p>
      
      <h2>äºŒã€ä»å‘½ç†è§’åº¦çœ‹ï¼Œæ ¸å¿ƒç»“è®ºæ˜¯ä»€ä¹ˆ</h2>
      <p>ä»å…«å­—ç´«å¾®æ–—æ•°çš„è§’åº¦æ¥çœ‹ï¼Œæ¯ä¸ªäººçš„æ„Ÿæƒ…è¿åŠ¿éƒ½æœ‰å…¶ç‹¬ç‰¹çš„è§„å¾‹å’ŒèŠ‚å¥ã€‚</p>
      
      <h2>ä¸‰ã€ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µ</h2>
      <p>å‘½ç†ä¸Šçš„æ„Ÿæƒ…è¿åŠ¿å—å¤šç§å› ç´ å½±å“ï¼ŒåŒ…æ‹¬åŸç”Ÿå…«å­—ç»“æ„ã€å¤§è¿æµå¹´ç­‰ã€‚</p>
      
      <h2>å››ã€å®ç”¨çš„æ”¹å–„å»ºè®®</h2>
      <ul>
        <li><strong>ä¸»åŠ¨å‡ºå‡»</strong>ï¼šæ‰©å¤§ç¤¾äº¤åœˆå­ï¼Œåˆ›é€ æ›´å¤šç›¸è¯†æœºä¼š</li>
        <li><strong>æå‡è‡ªæˆ‘</strong>ï¼šä»å†…å¤–åœ¨ä¸¤æ–¹é¢æå‡ä¸ªäººé­…åŠ›</li>
        <li><strong>æ—¶æœºæŠŠæ¡</strong>ï¼šå…³æ³¨è¿åŠ¿å˜åŒ–ï¼Œåœ¨åˆé€‚æ—¶æœºä¸»åŠ¨è¡ŒåŠ¨</li>
      </ul>
      
      <h2>äº”ã€ç»“è¯­</h2>
      <p>{question}è¿™æ ·çš„ç–‘é—®å¾ˆæ­£å¸¸ï¼Œè¯´æ˜æ‚¨å¯¹æ„Ÿæƒ…ç”Ÿæ´»æœ‰æ‰€æœŸå¾…ã€‚å‘½ç†æ˜¯ä¸€ç§æ–‡åŒ–ä¼ ç»Ÿå’Œæ™ºæ…§ä¼ æ‰¿ã€‚</p>
    </div>
    
    <div class=\"text-center mt-8\">
      <a href=\"/generate/bazi\" class=\"inline-flex items-center px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700\">
        ç”Ÿæˆå…«å­—æŠ¥å‘Š
      </a>
    </div>
  </article>
</body>
</html>'''
            
            filename = f'seo-{question.replace(\"ï¼Ÿ\", \"\").replace(\"ï¼Œ\", \"\")[:30]}.html'
            filepath = os.path.join('seo_pages', filename)
            
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(html)
        
        print('âœ… ç”Ÿæˆäº†30ç¯‡SEOæ–‡ç« ')
        "
        
        FILE_COUNT=$(ls seo_pages/*.html 2>/dev/null | wc -l)
        echo "ç”Ÿæˆæ–‡ä»¶æ•°é‡: $FILE_COUNT"
        
        if [ $FILE_COUNT -gt 0 ]; then
          echo "âœ… æ–‡ä»¶ç”ŸæˆæˆåŠŸ"
          cp seo_pages/*.html public/seo/
          echo "âœ… æ–‡ä»¶å¤åˆ¶å®Œæˆ"
        else
          echo "âŒ æ²¡æœ‰ç”ŸæˆHTMLæ–‡ä»¶"
          exit 1
        fi
    
    - name: Commit and push
      run: |
        git config --global user.name "Fortell365 Bot"
        git config --global user.email "bot@fortell365.com"
        
        git add public/seo/
        
        if git diff --cached --quiet; then
          echo "æ²¡æœ‰å˜æ›´éœ€è¦æäº¤"
          exit 0
        fi
        
        FILE_COUNT=$(ls seo_pages/*.html 2>/dev/null | wc -l)
        git commit -m "ğŸ¤– Auto SEO content - $FILE_COUNT articles - $(date '+%Y-%m-%d %H:%M:%S')"
        git push origin main
        echo "âœ… æ¨é€åˆ°GitHubæˆåŠŸ"
        
    - name: Success message
      run: |
        echo "ğŸ‰ SEOè‡ªåŠ¨åŒ–éƒ¨ç½²æˆåŠŸï¼"
        echo "ğŸ“Š ç”Ÿæˆç»Ÿè®¡ï¼š"
        echo "   - æ–‡ç« æ•°é‡: $(ls seo_pages/*.html 2>/dev/null | wc -l)"
        echo "   - æ—¶é—´: $(date)"
        echo "   - ä»“åº“: ${{ github.repository }}"
